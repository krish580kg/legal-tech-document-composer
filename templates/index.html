<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Legal Tech Adaptive Document Composer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body{background:#f3f4f6;}
    .brand-bar{background:#111827;color:#f9fafb;}
    .brand-logo{font-weight:700;letter-spacing:0.03em;}
    textarea{white-space:pre-wrap;font-family:"JetBrains Mono","Courier New",monospace;font-size:0.9rem;}
    .badge-tech{font-size:0.7rem;margin-left:0.35rem;}
    .card{border-radius:0.75rem;border:1px solid #e5e7eb;}
    .card-header{background:#f9fafb;border-bottom:1px solid #e5e7eb;}
    .pill-label{font-size:0.75rem;text-transform:uppercase;letter-spacing:0.06em;}
  </style>
</head>
<body>

<nav class="brand-bar py-2">
  <div class="container d-flex flex-column flex-md-row align-items-md-center justify-content-between">
    <div class="d-flex align-items-center gap-2">
      <span class="brand-logo">LexDraft</span>
      <span class="d-none d-sm-inline text-secondary" style="font-size:0.8rem;">Adaptive document composer</span>
    </div>
    <div class="mt-2 mt-md-0">
      <span class="badge bg-secondary badge-tech">Flask backend</span>
      <span class="badge bg-info text-dark badge-tech">AI text analysis</span>
      <span class="badge bg-success badge-tech">Smart clause engine</span>
    </div>
  </div>
</nav>

<div class="container py-4">

  <div class="mb-3 text-center">
    <span class="pill-label text-muted">Smart drafting for NDA & employment agreements</span>
  </div>

  <div class="row g-3">

    <div class="col-lg-4">
      <div class="card h-100 shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
          <span class="pill-label text-muted">Step 1 · Input</span>
          <span class="badge bg-light text-dark border">Draft settings</span>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label fw-semibold">Document type</label>
            <select id="docType" class="form-select">
              <option value="nda">Non-Disclosure Agreement (NDA)</option>
              <option value="employment">Employment Agreement</option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label fw-semibold">
              Use-case / Requirements
              <span class="badge bg-secondary badge-tech">Analysed by AI</span>
            </label>
            <textarea id="requirements" class="form-control" rows="6"
                      placeholder="Example: NDA between Alpha Innovations Pvt Ltd and Rohan Sharma for a startup product under development. Work is remote and involves 2 interns handling confidential research. Agreement valid for 6 months in Bengaluru."></textarea>
            <div class="form-text">
              Include details like parties, startup, remote work, interns, salary, locations, duration.
            </div>
          </div>

          <button id="generate-btn" class="btn btn-primary w-100 mb-2">Generate draft</button>
          <button id="download-btn" class="btn btn-outline-secondary w-100">Download draft (PDF)</button>

          <div id="status-text" class="form-text mt-2"></div>
          <div id="ai-summary" class="small text-muted mt-1"></div>
        </div>
      </div>
    </div>

    <div class="col-lg-8">
      <div class="card mb-3 shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
          <span class="pill-label text-muted">Step 2 · Analysis</span>
          <span class="text-muted" style="font-size:0.8rem;">AI entity extraction</span>
        </div>
        <div class="card-body">
          <p class="text-muted mb-2">
            The system analyses your requirements text and highlights detected entities such as
            organisations, people and locations.
          </p>
          <ul id="entities-list" class="mb-0"></ul>
        </div>
      </div>

      <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
          <span class="pill-label text-muted">Step 3 · Generated draft</span>
          <span class="text-muted" style="font-size:0.8rem;">Template clauses + adaptive clauses</span>
        </div>
        <div class="card-body">
          <textarea id="draft" class="form-control" rows="18"
                    placeholder="Generated legal draft will appear here. You can edit the text before exporting."></textarea>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
  const btn = document.getElementById('generate-btn');
  const downloadBtn = document.getElementById('download-btn');
  const draftBox = document.getElementById('draft');
  const entitiesList = document.getElementById('entities-list');
  const statusText = document.getElementById('status-text');
  const aiSummary = document.getElementById('ai-summary');

  btn.addEventListener('click', async () => {
    const requirements = document.getElementById('requirements').value.trim();
    const docType = document.getElementById('docType').value;
    if (!requirements) {
      statusText.textContent = "Please enter requirements text.";
      statusText.classList.add("text-danger");
      return;
    }
    statusText.textContent = "Generating draft…";
    statusText.classList.remove("text-danger");
    aiSummary.textContent = "";
    btn.disabled = true;
    try {
      const res = await fetch('/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ docType, requirements })
      });
      const data = await res.json();
      draftBox.value = data.draft || "";
      entitiesList.innerHTML = "";
      if (data.entities && data.entities.length > 0) {
        data.entities.forEach(([text, label]) => {
          const li = document.createElement('li');
          li.textContent = text + " (" + label + ")";
          li.classList.add('text-primary');
          entitiesList.appendChild(li);
        });
      } else {
        const li = document.createElement('li');
        li.textContent = "No entities detected.";
        li.classList.add('text-muted');
        entitiesList.appendChild(li);
      }
      const keywords = data.keywords || [];
      const adaptiveCount = data.adaptive_count || 0;
      if (keywords.length > 0) {
        aiSummary.textContent = "Keywords detected: " + keywords.join(", ") +
          " · Adaptive clauses added: " + adaptiveCount + ".";
      } else {
        aiSummary.textContent = "Draft generated from base template.";
      }
      statusText.textContent = "Draft ready.";
    } catch (err) {
      console.error(err);
      statusText.textContent = "Unable to generate draft.";
      statusText.classList.add("text-danger");
    } finally {
      btn.disabled = false;
    }
  });

  downloadBtn.addEventListener('click', () => {
    window.print();
  });
</script>

</body>
</html>
